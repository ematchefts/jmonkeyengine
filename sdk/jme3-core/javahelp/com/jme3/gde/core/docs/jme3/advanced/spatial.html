
<h1><a>Spatial</a></h1>
<div>

<p>

This is an introduction to the concept of Spatials, the elements of the 3D scene graph. The scene graph is a data structure that manages all objects in your 3D world. For example, the scene graph keeps track of the 3D models that you load and position. When you extend a Java class from com.jme3.app.SimpleApplication, you automatically inherit the scene graph and its rootNode. 
</p>

<p>
The rootNode is the central element of the scene graph. Even if the scene graph is empty, it always contains at least the rootNode. We <em>attach</em> Spatials to the rootNode. Attached Spatials are always in a <em>parent-child relationship</em>. Every time you attach a Spatial to something, it is implicitly detached from its previous parent. A Spatial can have only one parent. A Spatial can have several children.
</p>

<p>
If you think you need to understand the scene graph concept better, please read <a href="/com/jme3/gde/core/docs/jme3/scenegraph_for_dummies.html">Scenegraph for dummies</a> first.
</p>

</div>
<!-- EDIT1 SECTION "Spatial" [1-934] -->
<h2><a>Node versus Geometry</a></h2>
<div>

<p>

In your Java code, a Spatial is either a <code>com.jme3.scene.Node</code> or a <code>com.jme3.scene.Geometry</code>. You use the two for different purposes:
</p>

<p>
<img src="nbdocs:/com/jme3/gde/core/docs/jme3/intermediate/scene-graph.png">

</p>
<div><table>
	<tr>
		<td> </td><th>com.jme3.scene.Spatial </th>
	</tr>
	<tr>
		<th> Purpose: </th><td> A Spatial is an abstract data structure that stores transformations (translation, rotation, scale) of elements of the 3D scene graph. Spatials can be saved and loaded using the <a href="/com/jme3/gde/core/docs/jme3/advanced/asset_manager.html">Asset Manager</a>. </td>
	</tr>
	<tr>
		<td>  </td><th> com.jme3.scene.Geometry </th><th> com.jme3.scene.Node </th>
	</tr>
	<tr>
		<th> Visibility: </th><td> A Geometry represents a <strong>visible</strong> 3D object in the scene graph. </td><td> A Node is an <strong>invisible &quot;handle&quot;</strong> for a group of Spatials in the scene graph. </td>
	</tr>
	<tr>
		<th> Purpose:    </th><td> Use Geometries to represent an object&#039;s <strong>looks</strong>: Every Geometry contains a polygon mesh and a material, specifying its shape, color, texture, and opacity/transparency. <br/>
You can attach a Geometry to a Node. </td><td> Use Nodes to <strong>structure and group</strong> Geometries and other Nodes. Every Node is attached to one parent node, and each node can have zero or more children attached to itself. <br/>
<strong>When you transform (move, rotate, etc) a parent node, all its children are transformed (moved, rotated, etc).</strong> </td>
	</tr>
	<tr>
		<th> Content:    </th><td> Transformations; custom user data; <br/>
mesh, material;  </td><td> Transformations; custom user data; <br/>
no mesh, no material.</td>
	</tr>
	<tr>
		<th> Examples:   </th><td> Box, sphere, player, building, terrain, vehicle, missiles, NPCs, etc… </td><td> rootNode, guiNode, audioNode, a custom vehicleNode or shipNode with passengers attached, etc. </td>
	</tr>
</table></div>
<!-- EDIT3 TABLE [1151-2451] -->
<p>

<p><div>You never create a Spatial with <code><del>Spatial s = new Spatial();</del></code>! A Spatial is an abstract concept, like a mammal (there is no actual creature called &quot;mammal&quot; walking around here). You either create a Node or a Geometry object. Some methods however require a Spatial argument: This is because they are able to accept both Nodes and Geometries as arguments. In this case, you must <em>cast</em> a Node or Geometry to Spatial.
</div></p>
</p>

</div>
<!-- EDIT2 SECTION "Node versus Geometry" [935-2905] -->
<h3><a>Mesh</a></h3>
<div>

<p>

The polygon <a href="/com/jme3/gde/core/docs/jme3/advanced/mesh.html">Mesh</a> inside a Geometry can be one of three things:

</p>
<ul>
<li><div> <strong>Shapes:</strong> The simplest type of Meshes are jME&#039;s default <a href="/com/jme3/gde/core/docs/jme3/advanced/shape.html">Shape</a>s such as cubes and spheres. You can use several Shapes to build complex Geometries. Shapes are built-in and can be created without using the AssetManager.</div>
</li>
<li><div> <strong>3D Models:</strong> <a href="/com/jme3/gde/core/docs/jme3/advanced/3d_models.html">3D models and scenes</a> are also made up of meshes, but are more complex than Shapes. You create Models and Scenes in external 3D Mesh Editors and export them as Ogre <acronym title="Extensible Markup Language">XML</acronym> or Wavefront OBJ. Use the <a href="/com/jme3/gde/core/docs/jme3/advanced/asset_manager.html">Asset Manager</a> to load models into a your jME3 game.</div>
</li>
<li><div> <strong>Custom Meshes:</strong> Advanced users can create <a href="/com/jme3/gde/core/docs/jme3/advanced/custom_meshes.html">Custom Meshes</a> programmatically.</div>
</li>
</ul>

</div>
<!-- EDIT4 SECTION "Mesh" [2906-3585] -->
<h2><a>How to Add Fields and Methods to a Spatial</a></h2>
<div>

<p>

You can include custom user data –that is, custom Java objects and methods– in Nodes and Geometries. This is very useful for maintaining information about a game element, such as health, budget, ammunition, inventory, equipment, etc for players, or landmark locations for terrains, and much more. 
</p>

<p>
<p><div>Neither do you need to ever extend Node to be able to add custom accessor methods to a spatial – use <a href="/com/jme3/gde/core/docs/jme3/advanced/custom_controls.html">Custom Controls</a> instead. There is no need to create a custom class that extends Node or Geometry to be able to add custom fields – use the provided <code>setUserData()</code> method instead. Where ever the Spatial is accessible, you can easily access the object&#039;s game data and accessors this way.
</div></p>
</p>

<p>
The following example adds an integer field named <code>health</code> to the Spatil <code>player_node</code>, and initializes it to 100.

</p>
<pre>player_node.setUserData&#40;&quot;health&quot;, 100&#41;;</pre>

<p>
To be able to add accessors to the player, you create a <a href="/com/jme3/gde/core/docs/jme3/advanced/custom_controls.html">custom PlayerControl</a> class and add it to the Spatial. 

</p>
<pre>player_node.addControl&#40;PlayerControl.class&#41;;</pre>

<p>
In PlayerControl you define methods that set and get your users data in the <code>spatial</code> object.  
</p>
<pre>public int getHealth&#40;&#41; &#123;
  return &#40;Integer&#41;spatial.getUserData&#40;&quot;health&quot;&#41;;
&#125;
public void setHealth&#40;int h&#41; &#123;
  spatial.setUserData&#40;&quot;health&quot;,h&#41;;
&#125;</pre>

<p>
Elsewhere in your code, you can access this data wherever you have access to the Spatial <code>player_node</code>. 
</p>
<pre>health = player_node.getControl&#40;PlayerControl.class&#41;.getHealth&#40;&#41;;
...
player_node.getControl&#40;PlayerControl.class&#41;.setHealth&#40;99&#41;;</pre>
<ul>
<li><div> You can add as many data objects (including Strings, Integers, Floats, Arrays,) to a Spatial as you want. Just make sure to label them with unique Strings (<code>health</code>, <code>inventory</code>, <code>equipment</code>, etc). </div>
</li>
<li><div> The saved data can be custom Java objects if you make the custom Java class <a href="/com/jme3/gde/core/docs/jme3/advanced/save_and_load#custom_savable_class.html">implement the Savable interface</a>. </div>
</li>
<li><div> When you save a Spatial as a .j3o file, the custom data is saved, too, and it will be restored the next time you load the .j3o!</div>
</li>
</ul>

<p>

This is how you list all data keys that are already defined for one Spatial:
</p>
<pre>for&#40;String key : spatial.getUserDataKeys&#40;&#41;&#41;&#123;
    System.out.println&#40;spatial.getName&#40;&#41;+&quot;'s keys: &quot;+key&#41;;
&#125;</pre>

</div>
<!-- EDIT5 SECTION "How to Add Fields and Methods to a Spatial" [3586-5973] -->
<h2><a>How to Access a Named Sub-Mesh</a></h2>
<div>

<p>

Often after you load a scene or model, you need to access a part of it as an individual Geometry in the scene graph. Maybe you want to swap a character&#039;s weapon, or you want to play a door-opening animation. First you need to know the unique name of the sub-mesh.

</p>
<ol>
<li><div> Open the model in a 3D mesh editor, or in the jMonkeyEngine <acronym title="Software Development Kit">SDK</acronym>&#039;s Scene Composer. </div>
</li>
<li><div> Find out the existing names of sub-meshes in the model.</div>
</li>
<li><div> Assign unique names to sub-meshes in the model if neccessary.</div>
</li>
</ol>

<p>

In the following example, the Node <code>house</code> is the loaded model. The sub-meshes in the Node are called its children. The String, here <code>door 12</code>, is the name of the mesh that you are searching. 
</p>
<pre>Geometry submesh = &#40;Geometry&#41; houseScene.getChild&#40;&quot;door 12&quot;&#41;;</pre>

</div>
<!-- EDIT6 SECTION "How to Access a Named Sub-Mesh" [5974-] -->
<p><em><a href="http://jmonkeyengine.org/wiki/doku.php/jme3:advanced:spatial?do=export_xhtmlbody">view online version</a></em></p>
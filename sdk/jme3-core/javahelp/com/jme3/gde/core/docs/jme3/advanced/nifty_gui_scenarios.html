
<h1><a>Nifty GUI 1.3 Scenarios</a></h1>
<div>

<p>

This document contains best practices for typical NiftyGUI usercase scenarios. These tips assume that you have read the <a href="/com/jme3/gde/core/docs/jme3/advanced/nifty_gui.html">Introduction to jME3&#039;s Nifty GUI integration</a> first, and have laid out a basic <acronym title="Graphical User Interface">GUI</acronym> that interacts with your Java application. Here you learn how you integrate the <acronym title="Graphical User Interface">GUI</acronym> better, and add effects and advanced controls.
</p>

</div>

<h2><a>Java or XML?</a></h2>
<div>

<p>

You can build Nifty GUIs using <acronym title="Extensible Markup Language">XML</acronym> or Java syntax. Which one should you choose?
</p>
<ul>
<li><div> Build your basic static UI layout using <acronym title="Extensible Markup Language">XML</acronym> - it&#039;s cleaner to write and read. </div>
</li>
<li><div> While the game runs, you dynamically change the UI content using Java code. </div>
</li>
</ul>

<p>

This approach has the advantage that you can, for example, switch between a phone and a desktop UI by simply swapping one base <acronym title="Extensible Markup Language">XML</acronym> file. You design the swappable UI with different layouts, but use the same element IDs, so your dynamic Java code works the same no matetr which base <acronym title="Extensible Markup Language">XML</acronym> layout you use it on.
</p>

</div>

<h2><a>Switch Game States</a></h2>
<div>

<p>

In a JME game, you typically have three game states:
</p>
<ol>
<li><div> Stopped: The game is stopped, a StartScreen is displayed. </div>
</li>
<li><div> Running: The game is running, the in-game HudScreen is displayed. </div>
</li>
<li><div> Paused: The game is paused, a PausedScreen is displayed.</div>
</li>
</ol>

<p>

(Aside: Additionally, the Stopped state often contains a LoadScreen, LogonScreen, OptionsScreen, CharacterCreationScreen, HighScoreScreen, CreditsScreen, etc. Some games let you access the OptionsScreen in the Paused state as well. The Running state can also contain an InventoryScreen, ItemShopScreen, StatsScreen, SkillScreen, etc.)
</p>

<p>
In JME, game states are implemented as custom <a href="/com/jme3/gde/core/docs/jme3/advanced/application_states.html">AppState</a> objects. Write each AppState so it brings its own input mappings, rootNode content, update loop behaviour, etc with it.
</p>
<ol>
<li><div> Stopped: StartScreen AppState + GuiInputs AppState</div>
</li>
<li><div> Paused: PausedScreen AppState + GuiInputs AppState</div>
</li>
<li><div> Running: HudScreen AppState + InGameInputs AppState + BulletAppState (jme physics), …</div>
</li>
</ol>

<p>

When the player switches between game states, you detach one set of AppStates, and attach another. For example, when the player pauses the running game, you use a boolean switch to pause the game loop and deactivate the game inputs (shooting, navigation). The screen is overlayed with a PausedScreen, which contains a visible mouse pointer and a Continue button. When the player clicks Continue, the mouse pointer is deactivated, the in-game input and navigational mappings are activated, and the game loop continues.
</p>

</div>

<h2><a>Get Access to Application and Update Loop</a></h2>
<div>

<p>

Since you are writing a jME3 application, you can additionally make any ScreenController class extend the <a href="/com/jme3/gde/core/docs/jme3/advanced/application_states.html">AbstractAppState</a> class. 
This gives the ScreenController access to the application object and to the update loop!
</p>
<pre>public class StartScreenState extends AbstractAppState &#123;
&nbsp;
  private ViewPort viewPort;
  private Node rootNode;
  private Node guiNode;
  private AssetManager assetManager;
  private Node localRootNode = new Node&#40;&quot;Start Screen RootNode&quot;&#41;;
  private Node localGuiNode = new Node&#40;&quot;Start Screen GuiNode&quot;&#41;;
  private final ColorRGBA backgroundColor = ColorRGBA.Gray;  
&nbsp;
public StartScreenState&#40;SimpleApplication app&#41;&#123;
    this.rootNode     = app.getRootNode&#40;&#41;;
    this.viewPort     = app.getViewPort&#40;&#41;;
    this.guiNode      = app.getGuiNode&#40;&#41;;
    this.assetManager = app.getAssetManager&#40;&#41;;  
  &#125;
&nbsp;
  @Override
  public void initialize&#40;AppStateManager stateManager, Application app&#41; &#123;
    super.initialize&#40;stateManager, app&#41;;
    /** init the screen */    
  &#125;
&nbsp;
  @Override
  public void update&#40;float tpf&#41; &#123;
    /** any main loop action happens here */
  &#125;
&nbsp;
  @Override
  public void stateAttached&#40;AppStateManager stateManager&#41; &#123;
    rootNode.attachChild&#40;localRootNode&#41;;
    guiNode.attachChild&#40;localGuiNode&#41;;
    viewPort.setBackgroundColor&#40;backgroundColor&#41;;
  &#125;
&nbsp;
  @Override
  public void stateDetached&#40;AppStateManager stateManager&#41; &#123;
    rootNode.detachChild&#40;localRootNode&#41;;
    guiNode.detachChild&#40;localGuiNode&#41;;
  &#125;
&nbsp;
&#125;</pre>

</div>

<h2><a>Know Your Variables</a></h2>
<div>
<div><table>
	<tr>
		<th>Variable</th><th>Description</th>
	</tr>
	<tr>
		<td>${CALL.myMethod()} </td><td> Calls a method in the current ScreenController and gets the method&#039;s return String. The method can also be void and have a side effect, e.g. play a sound etc.</td>
	</tr>
	<tr>
		<td>${ENV.HOME}</td><td> Returns the path to user&#039;s home directory.</td>
	</tr>
	<tr>
		<td>${ENV.key} </td><td> Looks up <code>key</code> in the environment variables. Use it like Java&#039;s System.getEnv(&quot;key&quot;).</td>
	</tr>
	<tr>
		<td>${PROP.key}</td><td> looks up <code>key</code> in the Nifty properties. Use Nifty.setGlobalproperties(properties) and Nifty.getGlobalproperties(&quot;key&quot;). Or SystemGetProperties(key);</td>
	</tr>
</table></div>
<!-- EDIT1 TABLE [4107-4638] -->
<p>

See also: <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://sourceforge.net/apps/mediawiki/nifty-gui/index.php?title=MarkUp"><param name="text" value="<html><u>http://sourceforge.net/apps/mediawiki/nifty-gui/index.php?title=MarkUp</u></html>"><param name="textColor" value="blue"></object>
</p>

</div>

<h2><a>Use ScreenControllers for Mutally Exclusive Functionality</a></h2>
<div>

<p>

Technically you are free to create one ScreenController class for each screen, or reuse the same ScreenController for all or some of them. In the end it may be best to create individual ScreenControllers for functionality that is mutually exclusive.
</p>

<p>
For example, create a <code>MyHudScreen.java</code> for the <code>hud</code> screen, and a <code>MyStartScreen.java</code> for the <code>start</code> screen.
</p>
<ul>
<li><div> Include all user interface methods that are needed during the game (while the HUD is up) in <code>MyHudScreen.java</code>. Then make this class control all screens that can be up during the game (the HUD screen, a MiniMap screen, an Inventory screen, an Abilities or Skills screen, etc). All these screens possibly share data (game data, player data), so it makes sense to control them all with methods of the same <code>MyHudScreen.java</code> class.</div>
</li>
<li><div> The start screen, however, is mostly independent of the running game. Include all user interface methods that are needed outside the game (while you are on the start screen) in <code>MyStartScreen.java</code>. Then make this class control all screens that can be up outside the game (the Start screen, a Settings/Options screen, a HighScore screen, etc). All these classes need to read and write saved game data, so it makes sense to control them all with methods of the same <code>MyStartScreen.java</code> class.</div>
</li>
</ul>

</div>

<h2><a>Create a Load Screen</a></h2>
<div>

<p>
<a href="/com/jme3/gde/core/docs/jme3/advanced/loading_screen.html">loading_screen</a>

</p>

</div>

<h2><a>Create a Popup Menu</a></h2>
<div>

<p>
<a href="/com/jme3/gde/core/docs/jme3/advanced/nifty_gui_popup_menu.html">nifty GUI PopUp Menu</a>
</p>

</div>

<h2><a>Add Visual Effects</a></h2>
<div>

<p>

You can register effects to screen elements.
</p>
<ul>
<li><div> Respond to element events such as onStartScreen, onEndScreen, onHover, onFocus, onActive,</div>
</li>
<li><div> Trigger effects that change movement, blending, size, color, fading, and much more.</div>
</li>
</ul>

<p>

Here is an example that moves a panel when the startScreen opens. You place an &lt; effect &gt; tag inside the element that you want to  be affected.
</p>
<pre><span>&lt;panel height=&quot;25%&quot; width=&quot;35%&quot; ...&gt;</span>
  <span><span>&lt;effect&gt;</span></span>
    <span>&lt;onStartScreen name=&quot;move&quot; mode=&quot;in&quot; direction=&quot;top&quot; length=&quot;300&quot; startDelay=&quot;0&quot; inherit=&quot;true&quot;/&gt;</span>
  <span><span>&lt;/effect&gt;</span></span>
<span><span>&lt;/panel&gt;</span></span></pre>

<p>
Learn more from the NiftyGUI page:
</p>
<ul>
<li><div> <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://sourceforge.net/apps/mediawiki/nifty-gui/index.php?title=Effects"><param name="text" value="<html><u>http://sourceforge.net/apps/mediawiki/nifty-gui/index.php?title=Effects</u></html>"><param name="textColor" value="blue"></object></div>
</li>
</ul>

</div>

<h2><a>Add Sound Effects</a></h2>
<div>

<p>

Playing sounds using Nifty is also possible with a <code>playSound</code> effect as trigger. Remember to first register the sound that you want to play:
</p>
<pre><span>&lt;registerSound id=&quot;myclick&quot; filename=&quot;Interface/sounds/ButtonClick.ogg&quot; /&gt;</span>
...
<span><span>&lt;label&gt;</span></span>
  <span><span>&lt;effect&gt;</span></span>
    <span>&lt;onClick name=&quot;playSound&quot; sound=&quot;myclick&quot;/&gt;</span>
  <span><span>&lt;/effect&gt;</span></span>
<span><span>&lt;/label&gt;</span></span></pre>

</div>

<h2><a>Pass ClickLoc From Nifty to Java</a></h2>
<div>

<p>

After a mouse click, you may want to record the 2D clickLoc and send this info to your Java application. Typical ScreenController methods however only have a String argument. You&#039;d have to convert the String to ints.
</p>

<p>
To pass the clickLoc as two ints, you can use the special <code>(int x, int y)</code> syntax in the ScreenController:

</p>
<pre>  public void clicked&#40;int x, int y&#41; &#123;
    // here you can use the x and y of the clickLoc
  &#125;</pre>

<p>

In the Nifty <acronym title="Graphical User Interface">GUI</acronym> screen code (e.g. <acronym title="Extensible Markup Language">XML</acronym> file) you must call the <code>(int x, int y)</code> method <em>without</em> any parameters! 

</p>
<pre><span>&lt;interact onClick=&quot;clicked()&quot;/&gt;</span>  </pre>

<p>

You can name the method (here <code>clicked</code>) what ever you like, as long as you keep the argument syntax.
</p>

</div>

<h2><a>Loading Several XML Files</a></h2>
<div>

<p>

The basic Nifty <acronym title="Graphical User Interface">GUI</acronym> example showed how to use the <code>nifty.fromXML()</code> method to load one <acronym title="Extensible Markup Language">XML</acronym> file containing all Nifty <acronym title="Graphical User Interface">GUI</acronym> screens.
The following code sample shows how you can load several <acronym title="Extensible Markup Language">XML</acronym> files into one nifty object. Loading several files with <code>nifty.addXml()</code> allows you to use one <acronym title="Extensible Markup Language">XML</acronym> file per one screen layout. 
</p>
<pre>NiftyJmeDisplay niftyDisplay = new NiftyJmeDisplay&#40;assetManager, inputManager, audioRenderer, viewPort&#41;;
Nifty nifty = niftyDisplay.getNifty&#40;&#41;;
nifty.addXml&#40;&quot;Interface/Screens/OptionsScreen.xml&quot;&#41;;
nifty.addXml&#40;&quot;Interface/Screens/StartScreen.xml&quot;&#41;;
nifty.gotoScreen&#40;&quot;startScreen&quot;&#41;;
StartScreenControl screenControl = &#40;StartScreenControl&#41; nifty.getScreen&#40;&quot;startScreen&quot;&#41;.getScreenController&#40;&#41;;
OptionsScreenControl optionsControl = &#40;OptionsScreenControl&#41; nifty.getScreen&#40;&quot;optionsScreen&quot;&#41;.getScreenController&#40;&#41;;
stateManager.attach&#40;screenControl&#41;;
stateManager.attach&#40;optionsControl&#41;;
guiViewPort.addProcessor&#40;niftyDisplay&#41;;</pre>

</div>

<h2><a>Design Your Own Styles</a></h2>
<div>

<p>

By default, your Nifty <acronym title="Extensible Markup Language">XML</acronym> screens use the built.in styles:
</p>
<pre> <span>&lt;useStyles filename=&quot;nifty-default-styles.xml&quot; /&gt;</span> </pre>

<p>
But you can switch to a set of custom styles in your game project&#039;s asset directory like this:
</p>
<pre> <span>&lt;useStyles filename=&quot;Interface/Styles/myCustomStyles.xml&quot; /&gt;</span> </pre>

<p>
Inside myCustomStyles.xml you define styles like this:
</p>
<pre><span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span><span>&lt;nifty-styles&gt;</span></span>
  <span>&lt;useStyles filename=&quot;Interface/Styles/Font/myCustomFontStyle.xml&quot; /&gt;</span>
  <span>&lt;useStyles filename=&quot;Interface/Styles/Button/myCustomButtonStyle.xml&quot; /&gt;</span>
  <span>&lt;useStyles filename=&quot;Interface/Styles/Label/myCustomLabelStyle.xml&quot; /&gt;</span>
  ...
<span><span>&lt;/nifty-styles&gt;</span></span></pre>

<p>
Learn more about how to create styles by looking at the <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://sourceforge.net/apps/mediawiki/nifty-gui/index.php?title=Build_from_Source"><param name="text" value="<html><u>Nifty GUI source code</u></html>"><param name="textColor" value="blue"></object> for “nifty-style-black”. Copy it as a template and change it to create your own style.

</p>
<hr />

<p>
Learn more from the NiftyGUI page:
</p>
<ul>
<li><div> <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://sourceforge.net/apps/mediawiki/nifty-gui/index.php?title=Effects"><param name="text" value="<html><u>http://sourceforge.net/apps/mediawiki/nifty-gui/index.php?title=Effects</u></html>"><param name="textColor" value="blue"></object></div>
</li>
</ul>
<div><span>
	<a href="/wiki/doku.php/tag:gui?do=showtag&amp;tag=tag%3Agui">gui</a>,
	<a href="/wiki/doku.php/tag:documentation?do=showtag&amp;tag=tag%3Adocumentation">documentation</a>,
	<a href="/wiki/doku.php/tag:nifty?do=showtag&amp;tag=tag%3Anifty">nifty</a>,
	<a href="/wiki/doku.php/tag:hud?do=showtag&amp;tag=tag%3Ahud">hud</a>,
	<a href="/wiki/doku.php/tag:click?do=showtag&amp;tag=tag%3Aclick">click</a>,
	<a href="/wiki/doku.php/tag:state?do=showtag&amp;tag=tag%3Astate">state</a>,
	<a href="/wiki/doku.php/tag:states?do=showtag&amp;tag=tag%3Astates">states</a>,
	<a href="/wiki/doku.php/tag:sound?do=showtag&amp;tag=tag%3Asound">sound</a>,
	<a href="/wiki/doku.php/tag:effect?do=showtag&amp;tag=tag%3Aeffect">effect</a>
</span></div>

</div>
<p><em><a href="http://jmonkeyengine.org/wiki/doku.php/jme3:advanced:nifty_gui_scenarios?do=export_xhtmlbody">view online version</a></em></p>